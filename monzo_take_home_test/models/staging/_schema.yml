version: 2

models:
  - name: stg_account_event_history
    description: "This model incrementally tracks account events over time."
    columns:
      - name: unique_event_id
        description: "Unique identifier for each account event."
        tests:
          - unique
          - not_null

      - name: account_id_hashed
        description: "Identifier for each account."
        tests:
          - not_null

      - name: event_type
        description: "Type of event (created, closed, reopened) logged."
        tests:
          - not_null
          - accepted_values:
              values: ['created', 'closed', 'reopened']

      - name: event_timestamp
        description: "Timestamp at which the event occurred."
        tests:
          - not_null

      - name: technical_metadata
        description: "A JSON field that contains technical metadata about the pipeline."

  - name: stg_account_hub
    description: "This model provides a distinct view of all created accounts."
    columns:
      - name: account_id_hashed
        description: "Unique identifier for each account."
        tests:
          - unique
          - not_null

      - name: user_id_hashed
        description: "Unique identifier for the user associated with the account."
        tests:
          - not_null

      - name: account_type
        description: "The type of account"

      - name: technical_metadata
        description: "A JSON field that contains technical metadata about the pipeline."

  - name: stg_user_transactions
    description: "This model provides a daily summary of transactions per user."
    columns:
      - name: user_daily_transaction_id
        description: "Unique identifier for each user-day transaction count."
        tests:
          - unique
          - not_null

      - name: user_id_hashed
        description: "Unique identifier for each user."
        tests:
          - not_null

      - name: transaction_date
        description: "The date of the transactions."

      - name: total_transactions
        description: "Total number of transactions for the user on this date."